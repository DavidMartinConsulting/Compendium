---
title: "Creating a Powerpoint Document in R"
output: rmdformats::readthedown
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
#install.packages("flair")
library(flair)
```

# Files

[Materials](ppt_example.zip?raw=true)

Download Materials to practice on your own. Download, unzip, click on "Click_Here_to_Start.Rproj" and then inside of RStudio click on "ppt_parent_example.Rmd"

# Purpose of This Section

The purpose of this section is to explore how you can use a parent/child type relationship within R Markdown to produce a sequence of plots in a powerpoint file. This builds off of the previous example looking at the child/parent relationship. This example will show how you can create a powerpoint document with complex graphs that will iterate over several different columns. This example can be quite a bit more complicated, but that will be saved for a future example.

## Creating a Powerpoint from Markdown

Inside the parent document we must first load in the following libraries. 

```{r}
library(knitr)
library(tidyverse)
library(survival)
library(survminer)
```

Here I am simply reading in a new dataset from the `survival` package. I am working through and simply modifying the variables to be more useful in a survival analysis/regression example.


```{r}
lung <- lung %>% mutate(
  age_group = case_when(
    age <= 55 ~ "LT 55",
    age > 55 & age <= 70 ~ "Between 55 & 70", 
    age > 70 ~ "GT 70"))
vars <- c("time", "status", "sex", "age_group", "ph.ecog", "ph.karno", "pat.karno")
lung <- lung %>% select(all_of(vars))

var_names <- c("time", "status","Sex", "Age Group", "ECOG Performance", "Phys. Kanofsky", "Patient Karnofsky")
```
This example is just like the example we created in the child/parent tutorial. Here we are going to iterate over the 3rd through 7th columns and saving the code that is used in the child document.


```{r}
rmd <- sapply(
  3:7,
  function(x) {
    knit_expand("3_ppt_child.Rmd", x = x)
  }
)

rmd <- paste(rmd, collapse = "\n")
cat(rmd)
```

```{r results = "asis"}
rendered <- knit(text = rmd, quiet = TRUE)
cat(rendered, sep = "\n")
```


In this document I am knitting to an HTML to be able to show the code, etc. However, in your document you would knit to a ppt. You can do this by using the dropdown arrow next to the knit button and choosing ppt. Also, in the YAML (the header), you can include the following:

```{r}
# output:
#   powerpoint_presentation:
#     slide_level: 1
#     reference_doc: template1.potx
```
Using this format you can knit to a powerpoint and also provide a specific style so that the powerpoint is not simply a blank powerpoint. 
